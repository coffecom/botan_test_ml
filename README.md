# botan_test_ml

**Документация к скрипту.**

Скрипт «script.py» написан на Python 3.6, нужен соответствующий интерпретатор. «script_with_time.py» имеет такой же вывод и функционал, только на каждой итерации выводится время, за которое она произведена и за сколько в общем выполнен скрипт. **Под линуксом путь вводить с последним слэшем, "path/path/"**

Для запуска скрипта нужны пакеты:

·        **os** 

·        **torch**

·        **torchvision**

·        **PIL** 

·        **Shutil**

·        **time**

После запуска скрипта подгружается модель из файла «dropout_conv_train_lenet_100_eph.ph» *(файл должен находится в одной директории со скриптом)* и скрипт спрашивает папку, из которой нужно найти людей с очками *(проверки на корректность директории или файлов нет, так что могут вывалится ошибки, нужно что бы в папке лежали только картинки)*. После ввода директории скрипт скопирует все картинки с людьми в очках в директорию, из которой он был запущен.

Модель описана в скрипте и обучена на 100 эпохах на людях из датасета CelebA. Из датасета были взяты все картинки людей в очках и около двух тысяч фотографий без. Фотографии уже обрезаны в портретный вид, так что детекция лиц не применяется.  В репоззитории так же имеется архив glasses.zip с датасетом, на котором производилось обучение. 

Модель — это, по сути, LeNet, немного усовершенствованный. Представлю результаты тренировки *(красная линия – точность по тренировочным данным, синяя- точность по тестовым).* 

![Accuracy](/plot.png)

В общем точность на тестовых данных достигла 0.91, в связи с ограниченным временем считаю такую точность приемлемой. Посмотреть процесс обучения можно в файле: Glasses_experiments.ipynb

 

Гудаускайте Эвелина. Команда «4 ближайших соседа».
